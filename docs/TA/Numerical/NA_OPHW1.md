---
layout: default
title: 第1章上机作业
parent: 数值计算方法
grand_parent: 助教工作
nav_order: 21
---

{: .no_toc }

<details open markdown="block">
  <summary>
    目录
  </summary>
  {: .text-delta }
- TOC
{:toc}
</details>

# 第1章上机作业



## 上机作业基本要求

问题要回答清楚、结合上机试验得到的结果以及现成的理论进行解释．

## 第1章上机作业

**问题1：** 设计算法找出你所使用的计算机的机器精度、下溢值和上溢值，编程验证所设计算法的正确性．

**问题2：** 设计算法计算 $y= x−\sin x$，使得有效位的丢失最多 1 位．编程验证所设计算法的正确性．

**问题3：** 计算积分 $\displaystyle \int_0^1x^n\mathrm{e}^x\mathrm{d}x(n\ge 0)$，可用分部积分法计算得 $y_{n+1}=\mathrm{e}-(n+1)y_n$，编程验证按上述公式设计的算法不稳定．

**问题4：** 考虑由 $x_0=1$，$x_1=\dfrac{1}{3}$，$x_{n+1}=\dfrac{13}{3}x_n-\dfrac{4}{3}x_{n-1}$ 归纳定义的实数序列实现的算法是否稳定？如果将初值改为 $x_0=1$，$x_1=4$，数值稳定吗？

## 思路

### 问题1



### 问题2

有效位丢失了$k$位

当 $1-\dfrac{\sin x}{x}\le\dfrac{1}{2}$ 时，精度丢失不超过 1 位，直接调用库函数．

当 $1-\dfrac{\sin x}{x} > \dfrac{1}{2}$ 时，$|x| < 2$．利用泰勒展开，计算 $x-\sin x$ 的Taylor展开

$$\dfrac{x^3}{6}-\dfrac{x^5}{120} + \dfrac{x^7}{5040}-\cdots.$$

然后分析对于不同的 $x$，截断至多少项来进行近似计算．当 $|x| < 2$ 时，被截断的项满足

$$\begin{aligned}
\left\vert\sum\limits_{n=k}^{\infty}(-1)^k\dfrac{x^{2n+1}}{(2n+1)!}\right\vert 
&\le \vert x \vert^{2k+1}\sum\limits_{n=k}^{\infty}\dfrac{1}{(2n+1)!} \\
&\le \dfrac{2\vert x\vert^{2k+1}}{(2k+1)!} \\
&\le \dfrac{2^{2k+2}}{(2k+1)!}.
\end{aligned}$$

（也可以用带余项的Taylor展开式来得到与上式类似的不等式）

所以可以先取定 $k$ 使得 $\dfrac{2^{2k+2}}{(2k+1)!}$ 小于机器精度，这样，计算 $x-\sin x$ 与计算 $\sum\limits_{n=1}^{k-1}(-1)^k\dfrac{x^{2n+1}}{(2n+1)!}$ 之间的离散误差可忽略不计．

计算多项式可采用秦九韶算法(Horner算法)．利用这个算法，会出现舍入误差．

对舍入误差进行了理论分析的同学可以获得加分，没分析也不扣分（毕竟本题只是要求“编程验证”，没要求必须做理论分析）．

**加分点：** 用理论分析 $\sum\limits_{n=1}^{k-1}(-1)^k\dfrac{x^{2n+1}}{(2n+1)!}$ 的浮点运算舍入误差．

**减分点：** 
- 没说清楚 $|x|\le 2$ 该怎么进行近似计算；
- 没说清楚为什么只是取到 $k=4$ （即计算 $f(x)=\dfrac{x^3}{3!}-\dfrac{x^5}{5!}+\dfrac{x^7}{7!}$）；
- 在做数值试验时没有取 $x$ 充分接近 $0$ 时的数值表现情况．（比如，只是取到 $x=10^{-2}$ ．最好再取 $x=10^{-3},10^{-4},10^{-5},10^{-6}$ ）

**没必要写的点：** 
- 有同学分析了不等式 $1-\dfrac{\sin x}{x} \ge \dfrac{1}{2}$ 成立的 $x$ 的取值范围是 $|x| \ge 1.89549427$，这一步没什么必要．

**笑点：**
- 某同学说：学数学分析的时候手算 Fourier 级数系数的惨案意犹未尽
