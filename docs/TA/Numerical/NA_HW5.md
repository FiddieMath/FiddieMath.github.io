---
layout: default
title: 第5周作业 
parent: 数值计算方法
grand_parent: 助教工作
nav_order: 5
---

{: .no_toc }

<details open markdown="block">
  <summary>
    目录
  </summary>
  {: .text-delta }
- TOC
{:toc}
</details>

# 第 5 周作业（理论5）

讲义第二章21、24、25

# 解答

### 第21题解答

{: .problem}
> 已知 $f(x)$ 在 $[1,2]$ 的端点上满足
>
> $f(1)=1$, $f(2)=8$, $f'(1)=3$, $f'(2)=12$，
>
> 求 Hermite 插值多项式 $H_3(x)$ 以及 $f(1.5)$ 的近似值．

设 

$$\begin{aligned}
H_3(x)&=f(1)+f'(1)(x-1)+a(x-1)^2+b(x-1)^3 \\
&=1+3(x-1)+a(x-1)^2+b(x-1)^3.
\end{aligned}$$

则 $H_3'(x)=f'(1)+2a(x-1)+3b(x-1)^2$．

则 $H_3(1)=f(1)=1$，$H_3'(1)=f'(1)=3$．

由 $H_3(2)=f(2)=8$，得 $8=1+3+a+b$．①

由 $H_3'(2)=f'(2)=12$，得 $12=3+2a+3b$．②

由①②解得 $a=3$，$b=1$，因此 Hermite 插值多项式为

$$H_3(x)=1+3(x-1)+3(x-1)^2+(x-1)^3=x^3.$$

$f(1.5)$ 的近似值为 $H_3(1.5)=1.5^3=3.375$．



### 第24题解答

{: .problem}
> 设函数 $f(x)$ 在 $[a,b]$ 上具有四阶连续导数，构造三次多项式 $H_3(x)$ 使其满足插值条件
>
> $$H_3(a)=f(a), \, H_3'(a)=f'(a), \, H_3^{\prime\prime}(a)=f^{\prime\prime}(a), \, H_3^{\prime\prime}(b)=f^{\prime\prime}(b).$$

设 

$$H_3(x) = f(a) + f'(a)(x-a) + \dfrac{f^{\prime\prime}(a)}{2}(x-a)^2 + C(x-a)^3,$$

其中 $C$ 是待定系数，则 $H_3(x)$ 满足前三个插值条件，而

$$H_3^{\prime\prime}(x) = f^{\prime\prime}(a) + 6C(x-a),$$

代入 $x=b$ 结合第四个插值条件得 

$$C = \dfrac{f^{\prime\prime}(b)-f^{\prime\prime}(a)}{6(b-a)}.$$

这样便能得到 $H_3(x)$ 的表达式．

**【方法一】** 为求余项 $r(x) = f(x) - H_3(x)$，依据插值条件，可设 

$$r^{\prime\prime}(x) = K(x)(x-a)(x-b). \qquad (1)$$

设辅助函数为

$$F(t) = f^{\prime\prime}(t) - H_3^{\prime\prime}(t) - K(x)(t-a)(t-b),$$

仿照书上定理证明，用两次 Rolle 定理，得 $K(x) = \dfrac{f^{(4)}(\eta)}{2}$．对 $(1)$ 式积分两次，可得

$$r(x)=\int_a^x\mathrm{d}m\int_a^m\dfrac{f^{(4)}(\eta)}{2}(t-a)(t-b)\mathrm{d}t, \quad \eta\in[a,b]. \qquad (2)$$

用一下积分中值定理，把 $f^{(4)}(\eta)$ 项提到积分外面，上式变成

$$r(x)=\dfrac{f^{(4)}(\xi)}{2}\int_a^x\mathrm{d}m\int_a^m(t-a)(t-b)\mathrm{d}t, \quad \eta\in[a,b].$$

然后剩下的积分很容易算出结果为 

$$r(x)=\dfrac{(x-a)^3(x+a-2b)}{24}f^{(4)}(\xi).$$

**【方法二】** 令

$$K(x)=\dfrac{f(x)-H_3(x)}{(x-a)^3(x+a-2b)}, \qquad (3)$$

构造辅助函数

$$F(t)=f(t) - H_3(t) - K(x)(t-a)^3(t+a-2b), \qquad (4)$$

求导计算得

$$\begin{aligned}
F'(t)&=f'(t)-H_3'(t) - 2K(x)(t-a)^2(2t+a-3b), && (5) \\
F^{\prime\prime}(t)&=f^{\prime\prime}(t)-H_3^{\prime\prime}(t) - 12K(x)(t-a)(t-b). && (6)
\end{aligned}$$

由 $(3)(4)$ 式， $F(a)=F(x)=0$，依 Rolle 定理，存在 $\xi_1\in (a,x)$ 使得 $F'(\xi_1)=0$．

由 $(5)$ 式， $F'(a)=F'(\xi_1)=0$，依 Rolle 定理，存在 $\xi_2\in(a,\xi_1)$ 使得 $F^{\prime\prime}(\xi_2)=0$．

由 $(6)$ 式， $F^{\prime\prime}(a)=F^{\prime\prime}(\xi_2)=F^{\prime\prime}(b)=0$，依 Rolle 定理，存在 $\xi_3\in(a,\xi_2)$，$\xi_4\in(\xi_2,b)$，使得 $F^{(3)}(\xi_3)=F^{(4)}(\xi_4)=0$．

依 Rolle 定理，存在 $\xi\in(\xi_3,\xi_4)$，使得$F^{(4)}(\xi)=0$．求导计算得

$$F^{(4)}(t) = f^{(4)}(t) - H_3^{(4)}(t) - 24 K(x),$$

因为 $H_3^{(4)}(t)=0$，所以 $K(x) = \dfrac{f^{(4)}(\xi)}{24}$．最后，再结合 $(3)$ 可得

$$r(x)=\dfrac{(x-a)^3(x+a-2b)}{24}f^{(4)}(\xi).$$

**【方法三】** 如果不能想到余项表达式为

$$r(x) = K(x)(x-a)^3(x+a-2b),$$

也可以采用待定系数的方法，设

$$r(x) = K(x)(x-a)^3(x-s),$$

其中 $s$ 是待定系数，使得 $r(a)=r'(a)=r^{\prime\prime}(a)=r^{\prime\prime}(b)=0$．在后续用 Rolle 定理求解过程中，根据 $r^{\prime\prime}(b)=0$ 可解出 $s=2b-a$．

### 错解

**【错解1】** 得到 $(2)$ 之后就戛然而止．

**【错解2】** 计算出错，系数少了一个常数倍．

**【错解3】** 没按要求给出余项表达式，而是估计了余项的上界．不仅如此，估计时还漏绝对值．

**【错解4】** 直接说可设

$$r(x)=K(x)(x-a)^3(x+a-2b)$$

并辅助函数为

$$F(t) = f(t) - H_3(t) - K(x)(t-a)^3(t+a-2b),$$

然后就没有写 $(3)$ 式，直接断言 $F(x)=0$．为什么可这样设 $r(x)$ ？需写清楚现有哪个函数然后有哪个函数的问题．

应像方法二那样，先按 $(3)$ 式设 $K(x)$，最后得到 $K(x) = \dfrac{f^{(4)}(\xi)}{24}$，然后通分变形，最终得到

$$r(x) = f(x) - H_3(x) = K(x)(x-a)^3(x+a-2b).$$


**【错解5】** 用了3次Rolle定理，得到了奇怪的结果（包含了 $f$ 的三次导数），比如

$$K(x)=\dfrac{1}{6}\left[f^{(3)}(\xi) - \dfrac{f^{\prime\prime}(a)-f^{\prime\prime}(b)}{a-b}\right]$$


**【错解6】** 没有构造辅助函数然后用 Rolle 定理，设 $r(x) = f(x) - H_3(x)$，由题目条件可知 $r^{\prime\prime}(x)$ 至少有 2 个零点 $a$，$b$，假设

$$r^{\prime\prime}(x)=K(x-a)(x-b),$$

那么取不定积分可得

$$r'(x) = \dfrac{1}{2}K(x-a)^2(x-b) -\dfrac{1}{6}K(x-a)^3,$$

进一步

$$r(x) = \dfrac{1}{6}K(x-a)^3(x-b) -\dfrac{1}{12}K(x-a)^4.$$

**错因：** 从 $r^{\prime\prime}(x)$ 到 $r'(x)$ 取不定积分这一步是错的，因为 $K$ 不是常数，而是与 $x$ 有关的函数．


**【错解7】** 不同的同学构造了各种不同的辅助函数，比如

$$\begin{gathered}
F(t) = f(t) - H_3(t) - K(x)(t-a)^3(t-b), \\
F(t) = f(t) - H_3(t) - K(x)(t-a)^2(t-b)^2,
\end{gathered}$$

然后断言 $F(a)=F(x)=0$．为什么能说 $F(x)=0$ ？

**【错解8】** 设 $r(x) = K(x)(x-a)^3(x-b)^3$，构造辅助函数

$$F(t) = f(t) - H_3(t) - K(x)(t-a)^3(t-b)^3.$$

这样设 $r(x)$ 的后果是强行加入了题目没有的条件 $f(b)=H_3(b)$ 和 $f'(b) = H_3'(b)$，得到的余项是不对的．



### 第25题解答

{: .problem}
> 设函数 $f(x)$ 在 $[a,b]$ 上具有四阶连续导数，试构造三次多项式 $H_3(x)$，使其满足插值条件
>
> $$H_3(a)=f(a), \quad H_3(b)=f(b), \quad H_3(c)=f(c), H_3'(c)=f'(c).$$
> 
> 其中 $c=\dfrac{a+b}{2}$，并求其余项 $f(x)-H_3(x)$ 的表达式．

**【方法一】** 设

$$H_3(x) = f(c) + f'(c)(x-c) + (Ax+B)(x-c)^2,$$

其中 $A$，$B$是待定系数，则 $H_3(x)$ 满足最后两个插值条件．由前两个插值条件，得

$$\left\{\begin{aligned}
f(a) &= f(c) + f'(c)(a-c) + (Aa+B)(a-c)^2, \\
f(b) &= f(c) + f'(c)(b-c) + (Ab+B)(b-c)^2, \\
\end{aligned}\right.$$

看作关于 $A$，$B$ 的线性方程组，可解出 $A$，$B$．

**【方法二】** 设

$$H_3(x) = N_2(x) + A(x-x_0)(x-x_1)(x-x_2),$$

其中 $A$ 是待定系数，则 $H_3(x)$ 满足前三个插值条件．由最后一个插值条件，将 $A$ 解出来即可．

为了求余项，仿照书上的推导方法，反复用 Rolle 定理即可．

# 补充习题（助教友情提供）

**1．** 证明：具有结点 $t_0 < t_1 < \cdots < t_n$ 的一次样条函数可表示为

$$S(x)=ax+b+\sum\limits_{i=1}^{n-1}c_i|x-t_i|.$$

**2．** 在计算机中实现用三次样条函数来刻画平面或空间中的参数曲线．可参考[这个链接](/docs/TA/Numerical/Interp_Spline_App/)．

**3．** 已知$f(x)$在区间$[0,2]$上具有三阶连续导数，设

$$g(x)=f(0)+(f(1)-f(0))x+\dfrac{f(2)-2f(1)+f(0)}{2}(x^2-x)$$

证明：$\max\limits_{x\in[0,2]}\vert f(x)-g(x)\vert  \le \dfrac{\sqrt{3}}{27}\max\limits_{x\in[0,2]}\vert f^{(3)}(x)\vert$．

**4．【UC San Diego PhD Qualifying Exam, Sep 2007】**

设 $k\ge 1$ 是整数，$p_k(x)$ 是插值点为$(x_0,y_0)$, $(x_1,y_1)$, $\cdots$, $(x_k,y_k)$的Lagrange插值多项式，$q_k(x)$ 是插值点为$(x_1,y_1)$, $(x_2,y_2)$, $\cdots$, $(x_{k+1},y_{k+1})$的Lagrange插值多项式．定义

$$r_{k+1}(x)=\dfrac{(x-x_0)q_k(x)-(x-x_{k+1})p_k(x)}{x_{k+1}-x_0},$$

证明：$r_{k+1}(x)$是插值点为$(x_0,y_0)$, $(x_1,y_1)$, $\cdots$, $(x_k,y_k)$, $(x_{k+1},y_{k+1})$的插值多项式．

**5．** 本题是 Hermite 插值多项式的有关补充内容——插值零的定义及性质．

{: .new-title}
> Definition
> 
> **定义：** 若对于在基点 $x_0$, $x_1$, $\cdots$, $x_n$ 中重复出现 $k$ 次或更多次的每一点 $\xi$，都有 $f^{(k-1)}(\xi)=0$，则称 $f$ 在点 $x_0$, $x_1$, $\cdots$, $x_n$ 上 **插值零**．
> 
> 例如，我们称$f$在点1, 3, 8, 1, 13, 1, 8上插值零，如果
> 
> $$f(1)=f(3)=f(8)=f'(1)=f(13)=f''(1)=f'(8)=0.$$
> 
> 如果两个函数 $f$ 和 $g$ 使得 $f-g$ 在点  $x_0$, $x_1$, $\cdots$, $x_n$ 上插值零，我们称 $f$ 在点 $x_0$, $x_1$, $\cdots$, $x_n$ 上插值 $g$（或者 $g$ 在点 $x_0$, $x_1$, $\cdots$, $x_n$ 上插值 $f$）．

回答如下问题：

(1) 证明：一个多项式在点 $x_0$, $x_1$, $\cdots$, $x_n$ （允许重复）上插值零的充分必要条件是它包含因子 $\prod\limits_{j=0}^n(x-x_j)$．

(2) 设 $f$ 在基点 $x_0$, $x_1$, $\cdots$, $x_n$ 上插值 $g$，并且 $h$ 在这些点上插值零，证明：$f\pm ch$ 在这些点上插值 $g$．

(3) 证明：若 $f$ 在基点 $x_0$, $x_1$, $\cdots$, $x_n$ 上插值零，则 $f$ 在基点 $x_0$, $x_1$, $\cdots$, $x_{n-1}$ 上也插值零．

{: .new-title}
> Definition
> 
> **定义：** 设 $K$ 是域，一个 **$K$-代数** $A$ 满足如下条件：
>
> (i) $A$ 是含单位元的环；
>
> (ii) $A$ 是 $K$-线性空间，满足对任意 $k\in K$，$a,b\in A$，都有 $k(ab)=(ka)b=a(kb)$．
>
> **例1：** 包含 $K$ 的交换环是一个 $K$-代数，比如二元多项式环 $K[X,Y]$、形式幂级数环 $K[[X]]$．
>
> **例2：** 环 $M_n(K)$ 的加法和乘法分别用矩阵加法和矩阵乘法定义，则 $M_n(K)$ 是 $K$-代数．

(4) 给定基点 $x_0$, $x_1$, $\cdots$, $x_n$．证明：在这些点上插值零的函数集合构成一个 $\mathbf{R}$-代数．








